var Dumpling=Backbone.Model.extend({defaults:{name:"Bunny",image:"assets/dumpling.jpg",age:1,health:8,intelligence:15,juiciness:10,type:"xiaolongbao"},initialize:function(){this.on("update",this.setData),this.on("getNew",this.retrieve)},retrieve:function(){var a=this.get("newDum");this.getData(a)},processData:function(a){this.set("name",a.dumpling),this.set("age",a.age),this.set("health",a.health),this.set("intelligence",a.intelligence),this.set("juiciness",a.juiciness),this.set("type",a.type),this.set("image",a.image)},getData:function(a){var b=this,c={dumpling:a};$.ajax({type:"POST",url:"http://localhost:8080/data",data:c,success:function(a){console.log("success"),b.processData(a)},error:function(){console.log("error")}})},setData:function(){$.ajax({type:"POST",url:"http://localhost:8080/update",data:this.attributes,success:function(a){console.log("success setting data")},error:function(){console.log("error")}})}}),DumplingView=Backbone.View.extend({template:_.template('<h2 class="dumView">Home</h2>     <h2 class="statsView">Stats</h2><h2 class="feedView">Feed</h2>     <h2 class="playView">Play</h2> <h2 class="chooseView">Switch Dumpling</h2>     <h3 class="name"><%= name %>, says hi!</h3><img class="dumImg" src="<%= image %>"/>'),events:{"click .statsView":"changeToStats","click .feedView":"changeToFood","click .playView":"changeToPlay","click .chooseView":"changeToChoose"},initialize:function(){this.render(),$("body").append(this.$el),this.collection.on("changeDums",this.render,this)},render:function(){this.$el.show(),this.$el.children().detach(),this.collection.forEach(this.renderDumpling,this);var a=this.$el.children("img")[0],b=function(){d3.select(a).style({"margin-left":"-300px"}).transition().duration(2e3).ease("quad").style({"margin-left":"300px"}).transition().duration(2e3).ease("quad").style({"margin-left":"-300px"})};b(),setInterval(b,4e3)},renderDumpling:function(a){this.$el.append(this.template(a.attributes))},changeToStats:function(){this.$el.hide(),this.collection.trigger("changeStats")},changeToFood:function(){this.$el.hide(),this.collection.trigger("changeFood")},changeToPlay:function(){this.$el.hide(),this.collection.trigger("changePlay")},changeToChoose:function(){this.$el.hide(),this.collection.trigger("changeChoose")}}),FeedView=Backbone.View.extend({template:_.template('<h2 class="dumView">Home</h2>     <h2 class="statsView">Stats</h2><h2 class="feedView">Feed</h2>     <h2 class="playView">Play</h2> <h2 class="chooseView">Switch Dumpling</h2>     <img class="dumImg" src="<%= image %>"/><img class="food" src="assets/food.png"/>'),events:{"click .dumView":"changeToDums","click .statsView":"changeToStats","click .playView":"changeToPlay","click .chooseView":"changeToChoose"},initialize:function(){$("body").append(this.$el),this.collection.on("changeFood",this.render,this)},render:function(){this.$el.show(),this.$el.children().detach(),this.collection.forEach(this.renderDumpling,this),this.animateFood(),this.collection.forEach(this.improveHealth,this)},renderDumpling:function(a){this.$el.append(this.template(a.attributes))},animateFood:function(){var a=this.$el.children("img")[1];d3.select(a).style({"margin-left":"5px"}).transition().duration(1e3).style({"margin-left":"-5px"}).style({transform:"scale(1,1)"}).transition().duration(1e3).style({transform:"scale(0,0)"})},improveHealth:function(a){a.set("health",a.get("health")+3),a.trigger("update")},changeToDums:function(){this.$el.hide(),this.collection.trigger("changeDums")},changeToStats:function(){this.$el.hide(),this.collection.trigger("changeStats")},changeToPlay:function(){this.$el.hide(),this.collection.trigger("changePlay")},changeToChoose:function(){this.$el.hide(),this.collection.trigger("changeChoose")}}),PlayView=Backbone.View.extend({template:_.template('<h2 class="dumView">Home</h2>     <h2 class="statsView">Stats</h2><h2 class="feedView">Feed</h2>     <h2 class="playView">Play</h2> <h2 class="chooseView">Switch Dumpling</h2>     <img class="dumImg" src="<%= image %>"/><img class="game" src="assets/game.png"/> '),events:{"click .dumView":"changeToDums","click .statsView":"changeToStats","click .feedView":"changeToFood","click .chooseView":"changeToChoose"},initialize:function(){$("body").append(this.$el),this.collection.on("changePlay",this.render,this)},render:function(){this.$el.show(),this.$el.children().detach(),this.collection.forEach(this.renderDumpling,this),this.collection.forEach(this.improveIntelligence,this)},renderDumpling:function(a){this.$el.append(this.template(a.attributes)),this.animateGame(),this.animateGame()},animateGame:function(){var a=this.$el.children("img")[1];d3.select(a).style({"margin-left":"-5px"}).style({transform:"rotateZ(0deg)"}).transition().duration(1e3).ease("bounce").style({"margin-left":"5px"}).style({transform:"rotateZ(180deg)"}).transition().duration(1e3).style({transform:"rotateZ(360deg)"}).style({"margin-left":"-5px"})},improveIntelligence:function(a){a.set("intelligence",a.get("intelligence")+3),a.trigger("update")},changeToDums:function(){this.$el.hide(),this.collection.trigger("changeDums")},changeToStats:function(){this.$el.hide(),this.collection.trigger("changeStats")},changeToFood:function(){this.$el.hide(),this.collection.trigger("changeFood")},changeToChoose:function(){this.$el.hide(),this.collection.trigger("changeChoose")}}),StatsView=Backbone.View.extend({template:_.template('<h2 class="dumView">Home</h2>     <h2 class="statsView">Stats</h2><h2 class="feedView">Feed</h2>     <h2 class="playView">Play</h2><h2 class="chooseView">Switch Dumpling</h2><div class="stats">     <h3>Name: <%= name %> </h3><h3>Type: <%= type %></h3></div>'),events:{"click .dumView":"changeToDums","click .feedView":"changeToFood","click .playView":"changeToPlay","click .chooseView":"changeToChoose"},initialize:function(){$("body").append(this.$el),this.collection.on("changeStats",this.render,this)},render:function(){this.$el.show(),this.$el.children().detach(),this.collection.forEach(this.renderStats,this)},renderStats:function(a){this.$el.append(this.template(a.attributes));var b=[a.attributes.health,a.attributes.age,a.attributes.juiciness,a.attributes.intelligence],c=["health","age","juiciness","intelligence"],d=100,e=5,f=d3.scale.linear().domain([0,d3.max(b)]).range(["#ffb832","#c61c6f"]),g=300,h=d3.select(this.el).append("svg").attr("height",g).attr("width",800);h.selectAll("rect").data(b).enter().append("rect").style("fill",f).attr("width",d).attr("height",function(a,b){return 25*a}).attr("x",function(a,b){return b*(d+e)}).attr("y",function(a){return g-25*a}),h.selectAll("text").data(c).enter().append("text").attr("font-size","20px").attr("width",100).attr("x",function(a,b){return 110*b}).attr("y",g-10).text(function(a){return a})},changeToDums:function(){this.$el.hide(),this.collection.trigger("changeDums")},changeToFood:function(){this.$el.hide(),this.collection.trigger("changeFood")},changeToPlay:function(){this.$el.hide(),this.collection.trigger("changePlay")},changeToChoose:function(){this.$el.hide(),this.collection.trigger("changeChoose")}}),ChooseView=Backbone.View.extend({template:_.template('<h2 class="dumView">Home</h2>     <h2 class="statsView">Stats</h2><h2 class="feedView">Feed</h2>     <h2 class="playView">Play</h2><h2 class="chooseView">Switch Dumpling</h2>     <div class="selections"><h1 class ="shumai">Lucy</h1><h1 class ="shrimp">Mark</h1>     <h1 class="xiaolongbao">Bunny</h1></div>'),events:{"click .statsView":"changeToStats","click .feedView":"changeToFood","click .playView":"changeToPlay","click .dumView":"changeToDums","click .shumai, .shrimp, .xiaolongbao":"switchIt"},initialize:function(){$("body").append(this.$el),this.collection.on("changeChoose",this.render,this)},render:function(){this.$el.show(),this.$el.children().detach(),this.collection.forEach(this.renderChoose,this)},renderChoose:function(a){this.$el.append(this.template(a.attributes))},switchIt:function(a){var b=$(a.target).text();"Lucy"===b?this.collection.forEach(this.triggerLucy,this):"Mark"===b?this.collection.forEach(this.triggerMark,this):"Bunny"===b&&this.collection.forEach(this.triggerBunny,this)},triggerMark:function(a){a.set("newDum","Mark"),a.trigger("getNew")},triggerLucy:function(a){a.set("newDum","Lucy"),a.trigger("getNew")},triggerBunny:function(a){a.set("newDum","Bunny"),a.trigger("getNew")},changeToStats:function(){this.$el.hide(),this.collection.trigger("changeStats")},changeToFood:function(){this.$el.hide(),this.collection.trigger("changeFood")},changeToPlay:function(){this.$el.hide(),this.collection.trigger("changePlay")},changeToDums:function(){this.$el.hide(),this.collection.trigger("changeDums")}});